{% extends 'admin_panel/base.html' %}
{% load static %}

{% block title %} معلومات عرض{% endblock %}

{% block content %}
<div class="content-header">
    <nav class="breadcrumb">
        <a href="{% url 'service-offers' %}">عروض الخدمات</a>
        <i class="separator fas fa-chevron-left"></i>
        <span>معلومات عرض</span>
        <i class="separator fas fa-chevron-left"></i>
    </nav>
</div>


<div class="content-body">
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="form-container">
            <div class="form-grid">
                <div class="form-section">
                    <div class="form-group">
                        <label>{{ form.expiresAt.label }}:</label>
                        {{ form.expiresAt }}
                        {% if form.expiresAt.errors %}
                        <div class="form-errors">
                            {{ form.expiresAt.errors }}
                        </div>
                        {% endif %}
                    </div>

                    <div class="form-group">
                        <label>{{ form.content.label }}:</label>
                        {{ form.content }}
                    </div>
                </div>

                <div class="form-section">
                    <div class="form-group">
                        <label>{{ form.organization.label }}:</label>
                        {{ form.organization }}
                    </div>
                    <div class="form-group">
                        <label>{{ form.organizations.label }}:</label>
                        {{ form.organizations }}
                        {% if form.organizations.errors %}
                        <div class="form-errors">
                            {{ form.organizations.errors }}
                        </div>
                        {% endif %}
                    </div>
                </div>

            </div>
        </div>

        <div class="form-button-container">
            <button class="btn btn-brown">
                حفظ
            </button>
            <a href="{% url 'service-offers' %}" class="btn btn-white">
                إلغاء
            </a>
        </div>
    </form>
</div>

<!-- Select2 CSS -->
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
<!-- Select2 JS -->
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
<script>
$(document).ready(function() {
    // Initialize Select2 with checkboxes for organizations field
    $('#id_organizations').select2({
        placeholder: "اختر المنظمات",
        width: '100%',
        closeOnSelect: false,
        templateResult: formatOrganization,
        templateSelection: formatOrganizationSelection
    });

    // Custom template for organization options
    function formatOrganization (data) {
        if (data.loading) return data.text;

        var $container = $(`<span>${data.text}</span>`);

        if (data.selected) {
            $container.prepend('<i class="fas fa-check"></i> ');
        }

        return $container;
    }

    // Custom template for selection
    function formatOrganizationSelection (data) {
        return data.text;
    }
});
</script>
{% endblock %}